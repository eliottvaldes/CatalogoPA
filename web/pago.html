<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="icon" type="image/png" href="assets/images/icon.png" sizes="192x192">
<title>Orden de pago</title>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.2/css/all.css">
  <link rel="stylesheet" href="assets/css/style_pay.css">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

</head>
<body>
	


<div class="container">
  <div class="payment">
    <div class="payment-logo">
      <p>P</p>
    </div>
    <h2>Orden de Pago</h2>
    <div class="form">
      <div class="card space icon-relative">
        <label class="label">Nombre de producto:</label>
          <label for="nombrepp"></label>
          <input class="color" id="nombrepp" value="super-tips" readonly disabled>        
      </div>
      <div class="card space icon-relative">
        <label class="label">Numero de Targeta:</label>
        <input type="text" class="input" data-mask="0000 0000 0000 0000" placeholder="0000 0000 0000 0000" required>
        <i class="far fa-credit-card"></i>
      </div>
      <div class="card-grp space">
        <div class="card-item icon-relative">
          <label class="label">Fecha de Expiración:</label>
          <input type="text" name="expiry-data" class="input" data-mask="00 / 00"  placeholder="00 / 00" minlength="7" required>
          <i class="far fa-calendar-alt"></i>
        </div>
        <div class="card-item icon-relative">
          <label class="label">CVC:</label>
          <input type="text" class="input" data-mask="000" placeholder="000" minlength="3" maxlength="3" required>
          <i class="fas fa-lock"></i>
        </div>
      </div>
        
      <div class="btn btn-danger" onclick="sb();">
        <p> Pagar </p>        
      </div> 
      
      <div class="btn btn-danger" onclick="cb();">
        <!-- Poner link del puto productSelected -->
        <a href="products.jsp"><p>Regresar</p></a>
               

      </div> 

    </div>
  </div>
</div>



<div hidden id="content">
  
  
  <div hidden id="nomp">
    <label for="nombrepp2">NOMBRE DEL PRODUCTO:</label><br><br>
    <div> <p> SuperTips(100) </p> </div>
  </div>

  <div hidden>
    <label for="preciopp">PRECIO UNITARIO DE PRODUCTO:</label><br><br>
    <div><p> $700.0 </p></div><br>
  </div> 
    
  <div hidden>
    <label for="cantidad">CANTIDAD</label><br><br>
    <div> 1 </div>  <br>
  </div> 
  
  <div hidden>
    <label for="cantidad">SUBTOTAL</label><br><br>
    <div> $700.0 </div>  <br>
  </div>
  
  <div hidden>
    <label for="cantidad">IVA:</label><br><br>
    <div> $112.0 </div>  <br>
  </div>
    
  <div hidden>
    <label for="cantidad">TOTAL: </label><br><br>
    <div> $812.0 </div>  <br>
  </div>
  
  <div hidden>
      <div>=================================</div><br>
    <label>FECHA DE COMPRA:</label><br>
    <div id="fechacompra"></div>  <br><br><br>
  </div>        

  <div hidden>
    <label >METODO DE PAGO:</label><br>
    <label>Tarjeta de Credito</label><br>

  </div>  


</div> <!-- FIn del id hidden -->

  <!-- <script>
    function getn() {
      var np = localStorage.getItem('nombrepp');
      /* var currentFont = localStorage.getItem('font'); */
      console.log("entra al getn")     
      
      /* document.getElementById('font').value = currentFont; */
       var nomp=document.getElementById('nomp').value;
       nomp.innerHTML="";
       nomp.innerHTML+=`
      <div hidden id="nomp">
        <label for="nombrepp">NOMBRE DEL PRODUCTO:</label><br>
        <input id="nombrepp" > <span>${np}</span>
      </div>
      `;     
    }
    
  </script>
 -->  
  <script>
    function hora(){
      var hoy = new Date();
      var fecha = hoy.getDate() + '-' + ( hoy.getMonth() + 1 ) + '-' + hoy.getFullYear();
      var hora = hoy.getHours() + ':' + hoy.getMinutes() + ':' + hoy.getSeconds();
      var fullDate= hora+" "+fecha;
      console.log(fullDate)
      var fechacompra=document.getElementById('fechacompra');
      fechacompra.innerHTML="";
      fechacompra.innerHTML+=`
      <div id="fechacompra">
        <span>${fullDate}</span>
      </div>  
      
      `;
    }
    hora();
    /* getn(); */
    
  </script>
  
  <script>
    function sb(){
      swal({
        title: "¿Esta seguro de querer terminar su compra?",
        icon: "warning",
        buttons: true,
        dangerMode: true,
        })
        .then((willDelete) => {
        if (willDelete) {
            jQuery(function(){
                swal({ title: "¡Enhorabuena, compra realizada con exito!",
                text: "Gracias por confiar en nosotros",
                icon: "success",
                button: "Aceptar"
                }).then(function() {
                    demoFromHTML();
                    removeItems();
                    window.location = "products.jsp";
                });
            }); 
        } else {
            swal("Proceso detenido");
        }
      });
    }
  </script>


<script>
  function demoFromHTML() {
      var pdf = new jsPDF('p', 'pt', 'letter');
      // source can be HTML-formatted string, or a reference
      // to an actual DOM element from which the text will be scraped.
      source = $('#content')[0];

      // we support special element handlers. Register them with jQuery-style 
      // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
      // There is no support for any other type of selectors 
      // (class, of compound) at this time.
      specialElementHandlers = {
          // element with id of "bypass" - jQuery style selector
          '#bypassme': function (element, renderer) {
              // true = "handled elsewhere, bypass text extraction"
              return true
          }
      };
      margins = {
          top: 80,
          bottom: 60,
          left: 40,
          width: 522
      };
      // all coords and widths are in jsPDF instance's declared units
      // 'inches' in this case
      pdf.fromHTML(
          source, // HTML string or DOM elem ref.
          margins.left, // x coord
          margins.top, { // y coord
              'width': margins.width, // max width of content on PDF
              'elementHandlers': specialElementHandlers
          },

          function (dispose) {
              // dispose: object with X, Y of the last line add to the PDF 
              //          this allow the insertion of new lines after html
              pdf.save('ticket_de_compra.pdf');
          }, margins
      );
  }
</script>

<script>
  function removeItems(){
    localStorage.removeItem('preciopp');
    localStorage.removeItem('nombrepp'); 
  }
</script>

<script>
  function cb(){
    swal({
        title: "¿Esta seguro de querer cancelar el proceso de compra?",
        icon: "warning",
        buttons: true,
        dangerMode: true,
        })
        .then((willDelete) => {
        if (willDelete) {
            jQuery(function(){
                swal({ title: "¡Proceso de compra cancelado!",
                text: "Puedes seguir viendo nuestros productos y comprarlos en un futuro o agregarlos al carrito",
                icon: "error",
                button: "Aceptar"
                }).then(function() {
                    removeItems();
                    window.location = "products.html";
                });
            }); 
        } else {
            swal("Has elegido seguir con la compra");
        }
    });


  }
</script>

	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.15/jquery.mask.min.js"></script>
  <script src="assets/js/funciones2.js"></script>
</body>
</html>